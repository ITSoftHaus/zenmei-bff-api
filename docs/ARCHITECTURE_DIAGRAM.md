# Diagrama de SincronizaÃ§Ã£o - BFF â†” Backend

## ğŸ¯ VisÃ£o Geral da Arquitetura

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FRONTEND (React + Firebase)                 â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   Login      â”‚  â”‚    MEI       â”‚  â”‚  ObrigaÃ§Ãµes  â”‚           â”‚
â”‚  â”‚   Social     â”‚  â”‚  Management  â”‚  â”‚   Fiscais    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚         â”‚                  â”‚                  â”‚                    â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                            â”‚                                       â”‚
â”‚                    JWT Token (Firebase)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ZENMEI-BFF-API (Port 8081)                    â”‚
â”‚                      Backend For Frontend Layer                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              MeiBffController                                â”‚ â”‚
â”‚  â”‚              /api/bff/v1/mei                                 â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  MEI Operations:                                             â”‚ â”‚
â”‚  â”‚  â€¢ GET    /                          â†’ listarMeis()          â”‚ â”‚
â”‚  â”‚  â€¢ GET    /{id}                      â†’ buscarMei()           â”‚ â”‚
â”‚  â”‚  â€¢ GET    /email/{email}             â†’ buscarMeiPorEmail()   â”‚ â”‚
â”‚  â”‚  â€¢ GET    /cpf/{cpf}                 â†’ buscarMeiPorCpf()     â”‚ â”‚
â”‚  â”‚  â€¢ GET    /cnpj/{cnpj}               â†’ buscarMeiPorCnpj()    â”‚ â”‚
â”‚  â”‚  â€¢ POST   /                          â†’ criarMei()            â”‚ â”‚
â”‚  â”‚  â€¢ PUT    /{id}                      â†’ atualizarMei()        â”‚ â”‚
â”‚  â”‚  â€¢ DELETE /{id}                      â†’ deletarMei()          â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  ObrigaÃ§Ãµes Fiscais:                                         â”‚ â”‚
â”‚  â”‚  â€¢ GET    /obrigacoes-fiscais/tipos  â†’ listarTipos()         â”‚ â”‚
â”‚  â”‚  â€¢ GET    /{id}/obrigacoes-fiscais   â†’ listarObrigacoes()    â”‚ â”‚
â”‚  â”‚  â€¢ GET    /{id}/obrigacoes-atrasadas â†’ listarAtrasadas()     â”‚ â”‚
â”‚  â”‚  â€¢ POST   /{id}/obrigacoes/{id}/fechar â†’ fecharObrigacao()   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Service Layer (Business Logic)                  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  MeiService                  ObrigacoesFiscaisService        â”‚ â”‚
â”‚  â”‚  â€¢ listarMeis()              â€¢ listarTiposObrigacoes()       â”‚ â”‚
â”‚  â”‚  â€¢ buscarMei()               â€¢ listarObrigacoesPorMei()      â”‚ â”‚
â”‚  â”‚  â€¢ criarMei()                â€¢ listarMeisComAtrasadas()      â”‚ â”‚
â”‚  â”‚  â€¢ atualizarMei()            â€¢ fecharObrigacao()             â”‚ â”‚
â”‚  â”‚  â€¢ deletarMei()              â€¢ calcularDiasAtraso()          â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  @CircuitBreaker âœ“           @CircuitBreaker âœ“               â”‚ â”‚
â”‚  â”‚  @Retry âœ“                    @Retry âœ“                        â”‚ â”‚
â”‚  â”‚  Fallback Methods âœ“          Fallback Methods âœ“              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Feign Clients (REST Communication)              â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  MeiClient                   ObrigacoesFiscaisClient         â”‚ â”‚
â”‚  â”‚  @FeignClient                @FeignClient                    â”‚ â”‚
â”‚  â”‚  name="mei-service"          name="mei-obrigacoes-service"   â”‚ â”‚
â”‚  â”‚  url="${mei.api.url}"        url="${mei.api.url}"            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚ HTTP/REST
                                 â”‚ Circuit Breaker Protected
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ZENMEI-MEI-API (Port 8080)                       â”‚
â”‚                   Business Logic Layer                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              MeiController                                   â”‚ â”‚
â”‚  â”‚              /api/v1/profile                                 â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â€¢ GET    /                  â†’ listarMeis()           âœ… NEW â”‚ â”‚
â”‚  â”‚  â€¢ GET    /{id}              â†’ getProfile()                  â”‚ â”‚
â”‚  â”‚  â€¢ GET    /email/{email}     â†’ getProfile()                  â”‚ â”‚
â”‚  â”‚  â€¢ GET    /cpf/{cpf}         â†’ getProfileByCpf()             â”‚ â”‚
â”‚  â”‚  â€¢ GET    /cnpj/{cnpj}       â†’ getProfileByCnpj()            â”‚ â”‚
â”‚  â”‚  â€¢ POST   /                  â†’ criarMei()             âœ… NEW â”‚ â”‚
â”‚  â”‚  â€¢ PUT    /{id}              â†’ atualizarMei()         âœ… NEW â”‚ â”‚
â”‚  â”‚  â€¢ DELETE /{id}              â†’ deletarMei()           âœ… NEW â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚        ObrigacoesFiscaisController         âœ… NEW CONTROLLER â”‚ â”‚
â”‚  â”‚        /api/v1/mei                                           â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â€¢ GET  /obrigacoes-fiscais/tipos        â†’ listarTipos()    â”‚ â”‚
â”‚  â”‚  â€¢ GET  /{id}/obrigacoes-fiscais         â†’ listarPorMei()   â”‚ â”‚
â”‚  â”‚  â€¢ GET  /obrigacoes-atrasadas            â†’ listarAtrasadas()â”‚ â”‚
â”‚  â”‚  â€¢ POST /{id}/obrigacoes-fiscais/{id}/fechar â†’ fechar()     â”‚ â”‚
â”‚  â”‚  â€¢ POST /{id}/obrigacoes-fiscais         â†’ criar()          â”‚ â”‚
â”‚  â”‚  â€¢ PUT  /{id}/obrigacoes-fiscais/{id}    â†’ atualizar()      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Service Layer                                   â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  MeiService                  ObrigacoesFiscaisService âœ… NEW â”‚ â”‚
â”‚  â”‚  â€¢ create()                  â€¢ listarTiposObrigacoes()       â”‚ â”‚
â”‚  â”‚  â€¢ findAll()          âœ… NEW â€¢ listarObrigacoesPorMei()      â”‚ â”‚
â”‚  â”‚  â€¢ findById()                â€¢ listarMeisComAtrasadas()      â”‚ â”‚
â”‚  â”‚  â€¢ findByEmail()             â€¢ fecharObrigacao()             â”‚ â”‚
â”‚  â”‚  â€¢ update()                  â€¢ criarObrigacao()              â”‚ â”‚
â”‚  â”‚  â€¢ delete()           âœ… NEW â€¢ atualizarObrigacao()          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Repository Layer (JPA)                          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â€¢ MeiRepository                                             â”‚ â”‚
â”‚  â”‚  â€¢ ObrigacoesFiscaisRepository                               â”‚ â”‚
â”‚  â”‚  â€¢ MeiObrigacoesFiscaisRepository                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚ JPA/Hibernate
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ZENMEI-MODEL-LIB                            â”‚
â”‚                        Shared Data Models                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Entities:                        DTOs:                            â”‚
â”‚  â€¢ Mei                            â€¢ TipoObrigacaoFiscalResponse    â”‚
â”‚  â€¢ ObrigacoesFiscais              â€¢ ObrigacaoFiscalResponse        â”‚
â”‚  â€¢ MeiObrigacoesFiscais           â€¢ MeiObrigacoesAtrasadasResponse â”‚
â”‚  â€¢ Produto, Servico, etc.         â€¢ ObrigacaoAtrasadaResponse      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          PostgreSQL Database                       â”‚
â”‚                                                                    â”‚
â”‚  Tables:                                                           â”‚
â”‚  â€¢ mei_profile                                                     â”‚
â”‚  â€¢ obrigacoes_fiscais                                              â”‚
â”‚  â€¢ mei_obrigacoes_fiscais                                          â”‚
â”‚  â€¢ produtos, servicos, clientes, notas_fiscais, etc.               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Fluxo de RequisiÃ§Ã£o

### Exemplo: Fechar ObrigaÃ§Ã£o Fiscal

```
1. Frontend
   â”‚
   â””â”€â–º POST /api/bff/v1/mei/{idMei}/obrigacoes-fiscais/{id}/fechar
       Headers: { Authorization: Bearer <JWT_TOKEN> }
       
2. BFF - MeiBffController
   â”‚
   â”œâ”€â–º Valida JWT (Firebase)
   â”œâ”€â–º Log: "Request to close fiscal obligation {id} for MEI {idMei}"
   â”‚
   â””â”€â–º ObrigacoesFiscaisService.fecharObrigacao(idMei, id)
       
3. BFF - ObrigacoesFiscaisService
   â”‚
   â”œâ”€â–º @CircuitBreaker ativa
   â”œâ”€â–º @Retry ativa (max 3 tentativas)
   â”‚
   â””â”€â–º ObrigacoesFiscaisClient.fecharObrigacao(idMei, id)
       
4. Feign Client
   â”‚
   â”œâ”€â–º Serializa request
   â”œâ”€â–º HTTP POST â†’ http://localhost:8080/api/v1/mei/{idMei}/obrigacoes-fiscais/{id}/fechar
   â”‚
   â””â”€â–º Se falhar â†’ Fallback Method
       
5. Backend - ObrigacoesFiscaisController
   â”‚
   â””â”€â–º ObrigacoesFiscaisService.fecharObrigacao(idMei, id)
       
6. Backend - ObrigacoesFiscaisService
   â”‚
   â”œâ”€â–º Busca MeiObrigacoesFiscais no Repository
   â”œâ”€â–º Atualiza status para "CONCLUIDA"
   â”œâ”€â–º Salva no banco de dados
   â”œâ”€â–º Converte Entity â†’ DTO
   â”‚
   â””â”€â–º Return ObrigacaoFiscalResponse
       
7. Response Chain
   â”‚
   Backend Controller â†’ Feign Client â†’ BFF Service â†’ BFF Controller â†’ Frontend
   
   Status: 200 OK
   Body: {
     "id": "uuid",
     "idMei": "uuid",
     "obrigacao": "DAS Mensal",
     "status": "CONCLUIDA",
     ...
   }
```

## ğŸ“Š Endpoints Comparison Matrix

| Feature | BFF Endpoint | Backend Endpoint | Method | Status |
|---------|-------------|------------------|--------|--------|
| List MEIs | `/api/bff/v1/mei` | `/api/v1/profile` | GET | âœ… |
| Get MEI | `/api/bff/v1/mei/{id}` | `/api/v1/profile/{id}` | GET | âœ… |
| Get by Email | `/api/bff/v1/mei/email/{email}` | `/api/v1/profile/email/{email}` | GET | âœ… |
| Get by CPF | `/api/bff/v1/mei/cpf/{cpf}` | `/api/v1/profile/cpf/{cpf}` | GET | âœ… |
| Get by CNPJ | `/api/bff/v1/mei/cnpj/{cnpj}` | `/api/v1/profile/cnpj/{cnpj}` | GET | âœ… |
| Create MEI | `/api/bff/v1/mei` | `/api/v1/profile` | POST | âœ… |
| Update MEI | `/api/bff/v1/mei/{id}` | `/api/v1/profile/{id}` | PUT | âœ… |
| Delete MEI | `/api/bff/v1/mei/{id}` | `/api/v1/profile/{id}` | DELETE | âœ… |
| List Obligation Types | `/api/bff/v1/mei/obrigacoes-fiscais/tipos` | `/api/v1/mei/obrigacoes-fiscais/tipos` | GET | âœ… |
| List MEI Obligations | `/api/bff/v1/mei/{id}/obrigacoes-fiscais` | `/api/v1/mei/{id}/obrigacoes-fiscais` | GET | âœ… |
| List Overdue | `/api/bff/v1/mei/{id}/obrigacoes-atrasadas` | `/api/v1/mei/obrigacoes-atrasadas` | GET | âœ… |
| Close Obligation | `/api/bff/v1/mei/{id}/obrigacoes-fiscais/{id}/fechar` | `/api/v1/mei/{id}/obrigacoes-fiscais/{id}/fechar` | POST | âœ… |

**Legend:**
- âœ… = Fully Synchronized
- ğŸ”„ = In Progress
- âŒ = Not Implemented

## ğŸ¨ Color-Coded Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ¨ LAYER COLORS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”µ Blue   = Frontend (React)                                â”‚
â”‚  ğŸŸ¢ Green  = BFF Layer (Gateway)                             â”‚
â”‚  ğŸŸ¡ Yellow = Backend API (Business Logic)                    â”‚
â”‚  ğŸŸ  Orange = Data Layer (JPA/Database)                       â”‚
â”‚  ğŸŸ£ Purple = Shared Models (DTOs/Entities)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Documento gerado por:** JamesCoder  
**Data:** 23/01/2026  
**Status:** âœ… Completo e Validado
